"use strict";

!function () {
  function t(t, e, i) {
    this.input = t, this.imgUrl = null, this.fileList = null, this.asynCallback = null, this.asyn = void 0 === i || i, this.callback = void 0 !== e && "function" == typeof e ? e : null, this.init();
  }

  void 0 !== window.createObjectURL ? t.prototype.createObjectURL = window.createObjectURL : window.URL && window.URL.createObjectURL ? t.prototype.createObjectURL = window.URL.createObjectURL : void 0 !== window.webkitURL && (t.prototype.createObjectURL = window.webkitURL.createObjectURL), t.prototype.supportPreview = function () {
    var e = document.createElement("div");
    return e.innerHTML = '<input type="file"/>', void 0 != e.firstChild.files && void 0 != t.prototype.createObjectURL;
  }(), t.prototype.supportPreview ? t.prototype.init = function () {
    var t = this;
    $(this.input).on("change", function () {
      t.getImgUrl(), t.callback(t.imgUrl);
    });
  } : t.prototype.init = function () {
    $(this.input).on("change", function () {
      this.parentNode.submit();
    }), this.asynCallback = function (t) {
      "SUCCESS" === t.state ? this.callback(t.url[0]) : alert(t.state);
    };
  }, t.prototype.pattern = /jpg$|jpeg$|png$|svg$|gif$|bmp$/i, t.prototype.getImgUrl = function () {
    var t = this.input,
        e = t.files,
        i = 0,
        n = e.length,
        o = [],
        r = [];

    if (this.pattern.test(this.input.value) && (this.imgUrl = this.createObjectURL(e[i]), this.fileList = e[i]), 1 != n) {
      for (++i; i < n; i++) {
        this.pattern.test(t.value) && (o.push(this.createObjectURL(e[i])), r.push(e[i]));
      }

      this.imgUrl = o, this.fileList = r;
    }
  }, t.prototype.supportPreview || $(document).ready(function () {
    var t, e;
    (e = document.createElement("div")).id = "preViewHidForm", e.innerHTML = '<iframe name="up" style="display:none"></iframe>', document.body.appendChild(e), (t = document.frames.up).src = "", t.target = "blank", void 0 === t.contentWindow ? t.document : t.contentWindow.document;
  }), window.ImgPreview = function (e, i, n) {
    return new t(e, i, n);
  }, window.ImgPreview.prototype = t.prototype;
}();